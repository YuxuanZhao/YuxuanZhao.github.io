<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Eason Chiu</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Eason Chiu">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Eason Chiu">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Eason Chiu">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Eason Chiu" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Eason Chiu</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-BackEnd-notes" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/08/04/BackEnd-notes/" class="article-date">
  <time datetime="2020-08-04T03:27:16.000Z" itemprop="datePublished">2020-08-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/08/04/BackEnd-notes/">BackEnd notes</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Static-vs-Dynamic"><a href="#Static-vs-Dynamic" class="headerlink" title="Static vs Dynamic"></a>Static vs Dynamic</h2><p>一个网页看起来会动不代表是dynamic的，dynamic意味着每次打开都可能是不同的html/css/js</p>
<p>网络是如何运作的？先从网站名查询到ip地址，向ip地址请求具体的网页，然后服务器在接收到HTTP的请求之后，确定如何response</p>
<p>GET 请求网页，取回：<a target="_blank" rel="noopener" href="http://www.reddit.com/search?q=cats">http://www.reddit.com/search?q=cats</a> 我们有可能像这样传一些参数，但是这些参数不会添加到database里面去</p>
<h2 id="Command-Line"><a href="#Command-Line" class="headerlink" title="Command Line"></a>Command Line</h2><p>ls 显示当前所在的所有的文件和文件夹（list）</p>
<p>cd 更改所在的路径 change directories</p>
<p>touch 创建新文件</p>
<p>mkdir 创建文件夹</p>
<p>rm 删除文件</p>
<p>rm -rf 删除文件夹里的所有东西 recursive force（-rf是一个flag）</p>
<blockquote>
<p>cd .. 的意思是返回到上一级的文件夹</p>
<p>cd xxx 进入xxx文件夹（只要写首字母+ tab，就有自动补全）</p>
<p>touch yellow.txt</p>
<p>mkdir FavColors</p>
<p>rm blue.txt</p>
</blockquote>
<p>node hello.js 运行hello.js</p>
<h2 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h2><p>我们想要使用npm的前提是先初始化好npm</p>
<blockquote>
<p><strong>npm init -f</strong> //直接初始化 package.json, -f 用于跳过问题直接开始</p>
<p><strong>npm install formidable –save</strong> //安装依赖，–save将此依赖信息存入package.json</p>
</blockquote>
<p>在.js 中使用npm</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> joke = <span class="built_in">require</span>(<span class="string">&quot;knock-knock-jokes&quot;</span>); <span class="comment">//include package</span></span><br><span class="line"><span class="built_in">console</span>.log(joke()); <span class="comment">//joke在这里就是这个package的方法</span></span><br></pre></td></tr></table></figure>

<p>使用faker这一个npm来产生一些假数据</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> faker = <span class="built_in">require</span>(<span class="string">&quot;faker&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> productName;</span><br><span class="line"><span class="keyword">var</span> productPrice;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;===================&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;WELCOME TO MY SHOP!&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;===================&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i  = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</span><br><span class="line">    productName = faker.commerce.product();</span><br><span class="line">    productPrice = faker.commerce.price();</span><br><span class="line">    <span class="built_in">console</span>.log(productName + <span class="string">&quot; - $&quot;</span> + productPrice);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="route"><a href="#route" class="headerlink" title="route"></a>route</h2><p>express和node js的关系就是，express是一个现成的Node js架构。可以使用中间件（body-parser）来响应HTTP请求（处理JSON等），定义路由器执行不同的HTTP请求的动作，使用模版传递参数动态渲染HTML的页面。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line"><span class="comment">//route: / =&gt; Hi there!</span></span><br><span class="line">app.get(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">    res.send(<span class="string">&quot;Hi there!&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> thing = req.params.thing;</span><br><span class="line">    res.render(<span class="string">&quot;home.ejs&quot;</span>, &#123;<span class="attr">thingVar</span>: thing&#125;);<span class="comment">//需要把文件放在名字为views的文件夹里</span></span><br><span class="line">&#125;);<span class="comment">//告诉电脑在home.ejs里面的EJS变量thingVar取thing这个变量的值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// /bye =&gt; Goodbye!</span></span><br><span class="line">app.get(<span class="string">&quot;/bye&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">    res.send(<span class="string">&quot;Goodbye!&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">&quot;*&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">   res.send(<span class="string">&quot;Page not found!&quot;</span>); <span class="comment">//work for all links that are not defined </span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//tell Express to listen for request (specify by Cloud9)</span></span><br><span class="line">app.listen(process.env.PORT, process.env.IP, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Server has started&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>我们不能把*匹配放在最前面，因为这样的话，所有的routing都会被拦截</p>
<p>route parameter</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在需要成为变量的位置前面加上：来区分</span></span><br><span class="line">app.get(<span class="string">&quot;/r/:subredditName/comments/:id/:title&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> subreddit = req.params.subredditName; <span class="comment">//取route变量的内容</span></span><br><span class="line">  res.send(<span class="string">&quot;Welcome to the &quot;</span> + subreddit + <span class="string">&quot;!&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h2><p>什么是package.json?它是一种用于描述app的很简略的meta data，比如contributor，dependency，license这样的信息。把package.json想象成是一份菜谱，别人在分享代码的时候，不想把依赖的所有的包都带上，因为这样会变得很大，而且你很可能已经安装了其中的一部分包了。所以在你收到菜谱之后，你根据现有的食材，再去补齐其余的食材将会是更好的办法。前面也有提到过应当如何去创建一个package.json: <strong>npm init</strong></p>
<h2 id="EJS-Embedded-Javascript"><a href="#EJS-Embedded-Javascript" class="headerlink" title="EJS (Embedded Javascript)"></a>EJS (Embedded Javascript)</h2><p>要npm install ejs</p>
<p>在HTML里面用JS来作为template</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--这就是要显示的EJS--&gt;&lt;%&#x3D; thingVar %&gt;</span><br><span class="line">&lt;% if (thingVar.toLowerCase() &#x3D;&#x3D;&#x3D; &quot;rusty&quot;)&#123; &lt;%&gt;</span><br><span class="line">  &lt;p&gt;</span><br><span class="line">    Good Choice!</span><br><span class="line">  &lt;&#x2F;p&gt;</span><br><span class="line">&lt;%&gt;  &#125;else&#123;  &lt;%&gt;</span><br><span class="line">  &lt;p&gt;</span><br><span class="line">    Bad Choice!</span><br><span class="line">  &lt;&#x2F;p&gt;</span><br><span class="line">&lt;%&gt; &#125; &lt;%&gt; &lt;!--这些只是逻辑的不要显示的没有等号--&gt;</span><br></pre></td></tr></table></figure>

<h2 id="DRY-css"><a href="#DRY-css" class="headerlink" title="DRY .css"></a>DRY .css</h2><p>创建一个新的文件夹 public 来盛放 .css 文件，但是默认的情况是express只会使用views这一个文件夹，其他的文件夹不会默认被纳入express使用的范围。使用下面的语句使得express能够使用public这一个文件夹。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.use(express.static(<span class="string">&quot;public&quot;</span>));</span><br><span class="line"></span><br><span class="line">app.set(<span class="string">&quot;view engine&quot;</span>, <span class="string">&quot;ejs&quot;</span>);<span class="comment">//使用这一语句之后，后面的res.render(&quot;home&quot;)就行，不需要给每一个都加上.ejs</span></span><br></pre></td></tr></table></figure>

<p>我们可以在views里面创建一个partial的文件夹，然后添加上footer.ejs + header.ejs。这两个就是所有其他的ejs文件都必须需要的header和footer的内容。在其他的ejs的头尾加上：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;% include partials&#x2F;header %&gt;</span><br><span class="line">&lt;% include partials&#x2F;footer %&gt;</span><br></pre></td></tr></table></figure>

<p>但是我们会发现我们的css没有成功连接上了。我们需要把css的链接改成不是在当前文件夹，而是从root开始查找。在前面加上/就行。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span> = <span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span> = <span class="string">&quot;text/css&quot;</span> <span class="attr">href</span> = <span class="string">&quot;/app.css&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bodyParser = <span class="built_in">require</span>(<span class="string">&quot;body-parser&quot;</span>);</span><br><span class="line">app.use(bodyParser.urlencoded(&#123;<span class="attr">extended</span>: <span class="literal">true</span>&#125;)); <span class="comment">//把request body转换成javascript object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> friends = [<span class="string">&quot;Tony&quot;</span>, <span class="string">&quot;Lily&quot;</span>];</span><br><span class="line"></span><br><span class="line">app.post(<span class="string">&quot;/addfriend&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> newfriend = req.body.newfriend;<span class="comment">//这里是吧form的输入的变量取出来</span></span><br><span class="line">        friends.push(newfriend);</span><br><span class="line">      res.redirect(<span class="string">&quot;/friends&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">&quot;/friends&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">  res.render(<span class="string">&quot;friends&quot;</span>, &#123;<span class="attr">friends</span>: friends&#125;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span> = <span class="string">&quot;/addfriend&quot;</span> <span class="attr">method</span> = <span class="string">&quot;POST&quot;</span>&gt;</span><span class="comment">&lt;!--action要对上js里的post地址，method选择POST--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span> = <span class="string">&quot;text&quot;</span> <span class="attr">name</span> = <span class="string">&quot;newfriend&quot;</span> <span class="attr">placeholder</span> = <span class="string">&quot;name&quot;</span>&gt;</span><span class="comment">&lt;!--这里的name就是我们把input收到的信息放入到request body的方式，即 newfriend: &quot;text-input&quot;--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span>&gt;</span></span><br><span class="line">      I made a new friend!</span><br><span class="line">  <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>npm body-parser –save</p>
</blockquote>
<h2 id="API-Application-Programming-Interface"><a href="#API-Application-Programming-Interface" class="headerlink" title="API (Application Programming Interface)"></a>API (Application Programming Interface)</h2><p>我们在请求API的时候，我们不需要html的format和各种css的格式。我们只需要纯纯的数据，所以这时候我们会使用json（Javascript Object Notation）或者xml（Extended Markup Language: key-value pair）。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;person&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;age&quot;</span>: <span class="string">&quot;21&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;Travis&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;city&quot;</span>: <span class="string">&quot;Los Angeles&quot;</span></span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">person</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">age</span>&gt;</span>21<span class="tag">&lt;/<span class="name">age</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>Travis<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">city</span>&gt;</span>LA<span class="tag">&lt;/<span class="name">city</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">person</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们需要先安装request npm：npm install request。如果我们知道某一个变量只会被assign一次就不会再变，我们应当把var改成const</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> request = <span class="built_in">require</span>(<span class="string">&quot;request&quot;</span>);</span><br><span class="line">request(<span class="string">&quot;http://www.google.com&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">error, response, body</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!error &amp;&amp; response.statusCode == <span class="number">200</span>)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(body);<span class="comment">//html内容，string格式</span></span><br><span class="line">    <span class="comment">//比如说我们拿到的是json，我么可以这样来处理</span></span><br><span class="line">    <span class="keyword">const</span> parsedData = <span class="built_in">JSON</span>.parse(body); <span class="comment">//把string变成javascript object</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;the temperature at Hawaii is &quot;</span> + parsedData[<span class="string">&quot;query&quot;</span>][<span class="string">&quot;results&quot;</span>][<span class="string">&quot;channel&quot;</span>][<span class="string">&quot;astronomy&quot;</span>]);</span><br><span class="line">    <span class="comment">//另一种写法</span></span><br><span class="line">    <span class="built_in">console</span>(<span class="string">`the temperature at Hawaii is <span class="subst">$&#123;parsedData.query.results.channel.astronomy&#125;</span>`</span>);</span><br><span class="line">    <span class="comment">//上引号指明里面的argument需要被处理成string，语法糖</span></span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//最新的语法</span></span><br><span class="line"><span class="keyword">const</span> rp = <span class="built_in">require</span>(<span class="string">&quot;request-promise&quot;</span>);</span><br><span class="line">rp(<span class="string">&quot;http://www.google.com&quot;</span>)</span><br><span class="line">    <span class="comment">//.then((body) =&gt; &#123;&#125;) 另一种写法</span></span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span>(<span class="params">body</span>)</span>&#123;</span><br><span class="line">          <span class="built_in">console</span>.log(body);</span><br><span class="line">&#125;)</span><br><span class="line">.catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>)</span>&#123;</span><br><span class="line">      <span class="comment">//.catch((err) =&gt; &#123;&#125;) 另一种写法</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Error!&quot;</span>, err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>我们在调用API的时候，应该怎么写链接？</p>
<p>omdbapi.com/?s=star&amp;plot=short</p>
<p>?给我们传参数的机会，&amp;让我们传入多个参数</p>
<h2 id="SQL-amp-NoSQL"><a href="#SQL-amp-NoSQL" class="headerlink" title="SQL &amp; NoSQL"></a>SQL &amp; NoSQL</h2><p>SQL是关系型，关系型是table类型的，不同的table要相互联系往往是使用一个id table来join。相反，NoSQL是一个非关系型的数据库使用方法，数据被储存成类似于javascript的object形式。</p>
<p>在AWS Cloud9里使用MongoDB：</p>
<blockquote>
<p>创建 touch mongodb-org-3.6.repo</p>
<p>把下列内容黏贴到该文件</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[mongodb-org-3.6]</span><br><span class="line">name&#x3D;MongoDB Repository</span><br><span class="line">baseurl&#x3D;https:&#x2F;&#x2F;repo.mongodb.org&#x2F;yum&#x2F;amazon&#x2F;2013.03&#x2F;mongodb-org&#x2F;3.6&#x2F;x86_64&#x2F;</span><br><span class="line">gpgcheck&#x3D;1</span><br><span class="line">enabled&#x3D;1</span><br><span class="line">gpgkey&#x3D;https:&#x2F;&#x2F;www.mongodb.org&#x2F;static&#x2F;pgp&#x2F;server-3.6.asc</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo mv mongodb-org-3.6.repo &#x2F;etc&#x2F;yum.repos.d</span><br><span class="line">sudo yum install -y mongodb-org</span><br></pre></td></tr></table></figure>

<p>关闭<strong>mongodb-org-3.6.repo</strong>文件，并在出现提示时按“ <strong>关闭”选项卡</strong></p>
<p>cd回ec2-user</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir data</span><br><span class="line">echo &#39;mongod --dbpath&#x3D;data --nojournal&#39; &gt; mongod</span><br><span class="line">chmod a+x mongod</span><br></pre></td></tr></table></figure>

<p>./mongod 打开，要在ec2-user～下进行</p>
</blockquote>
<p><strong>CRUD</strong> 在Mongo command line</p>
<blockquote>
<p>Create: db.dogs.insert({name: “Rusty”, breed: “Mutt”})</p>
<p>Read: db.dogs.find({breed: “Mutt”})</p>
<p>Update: db.dogs.update({name: “Rusty”}, {$set: (name: “Tater”, isCute: true)}) 这里第一个参数是要改动的object，第二个参数是需要改动的内容，可以增加不存在的attribute</p>
<p>Delete: db.dogs.remove({breed: “Mutt”})</p>
</blockquote>
<h2 id="Mongoose"><a href="#Mongoose" class="headerlink" title="Mongoose"></a>Mongoose</h2><p>在node js里更好地使用Mongo DB的一种工具。同样是使用npm进行下载。并在js里使用</p>
<p>npm install –save <a href="mailto:&#109;&#x6f;&#x6e;&#103;&#111;&#x6f;&#x73;&#x65;&#x40;&#x35;&#x2e;&#51;&#x2e;&#49;&#x35;">&#109;&#x6f;&#x6e;&#103;&#111;&#x6f;&#x73;&#x65;&#x40;&#x35;&#x2e;&#51;&#x2e;&#49;&#x35;</a>（最新的版本）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">&quot;mongoose&quot;</span>);</span><br><span class="line"></span><br><span class="line">mongoose.connect(<span class="string">&quot;mongodb://localhost/toys_hub&quot;</span>, &#123;<span class="attr">useNewUrlParser</span>: <span class="literal">true</span>, <span class="attr">useUnifiedTopology</span>: <span class="literal">true</span>&#125;);</span><br><span class="line"><span class="comment">//如果没有cat_app存在，那么这行代码和上面一样，会自动创建一个，27017是默认的端口</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//1.</span></span><br><span class="line"><span class="keyword">var</span> catSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">  name: <span class="built_in">String</span>,</span><br><span class="line">  age: <span class="built_in">Number</span>,</span><br><span class="line">  temperament: <span class="built_in">String</span></span><br><span class="line">&#125;); <span class="comment">//just pattern</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.</span></span><br><span class="line"><span class="keyword">var</span> Cat = mongoose.model(<span class="string">&quot;Cat&quot;</span>, catSchema);<span class="comment">//singular version of our model with many methods, create collections automatically with plural</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//1.</span></span><br><span class="line"><span class="keyword">var</span> george = <span class="keyword">new</span> Cat(&#123;</span><br><span class="line">  name: <span class="string">&quot;George&quot;</span>,</span><br><span class="line">  age: <span class="number">11</span>,</span><br><span class="line">  temperament:  <span class="string">&quot;Grouchy&quot;</span></span><br><span class="line">&#125;);<span class="comment">//create</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.</span></span><br><span class="line">george.save(<span class="function"><span class="keyword">function</span>(<span class="params">err, cat</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Something wrong&quot;</span>)</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Just saved a cat to the database:&quot;</span>);</span><br><span class="line">    cosole.log(cat);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);<span class="comment">//save to the collection, handle the error if not save successfully, callback run after the save() is run</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//another way</span></span><br><span class="line">Cat.create(&#123;</span><br><span class="line">  name: <span class="string">&quot;Snow White&quot;</span>,</span><br><span class="line">  age: <span class="number">15</span>,</span><br><span class="line">  temperament: <span class="string">&quot;Bland&quot;</span></span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err, cat</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(err)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(cat);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);<span class="comment">//use this create() function, to add directly, and the 2rd attribute is a callback function that handle unsuccessful situation</span></span><br><span class="line"></span><br><span class="line">Cat.find(&#123;&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err, cats</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Oh no, error!&quot;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;All the cats:&quot;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(cats);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);<span class="comment">//show all the cats and handle the error may be shown</span></span><br></pre></td></tr></table></figure>

<p>命令行看数据库里的内容</p>
<blockquote>
<p>mongo -&gt; show dbs -&gt; toys_hub -&gt; use toys_hub -&gt; show collections -&gt; db.toys.find()</p>
</blockquote>
<h2 id="RESTFUL-ROUTES"><a href="#RESTFUL-ROUTES" class="headerlink" title="RESTFUL ROUTES"></a>RESTFUL ROUTES</h2><table>
<thead>
<tr>
<th>name</th>
<th>url</th>
<th>verb</th>
<th>desc.</th>
</tr>
</thead>
<tbody><tr>
<td>INDEX</td>
<td>/dogs</td>
<td>GET</td>
<td>Display a list of dogs</td>
</tr>
<tr>
<td>NEW</td>
<td>/dogs/new</td>
<td>GET</td>
<td>Display form to create a dog</td>
</tr>
<tr>
<td>CREATE</td>
<td>/dogs</td>
<td>POST</td>
<td>Add new dog to DB</td>
</tr>
<tr>
<td>SHOW</td>
<td>/dogs/:id</td>
<td>GET</td>
<td>Shows info of one dog</td>
</tr>
<tr>
<td>EDIT</td>
<td>/dogs/:id/edit</td>
<td>GET</td>
<td>show edits form for a dog</td>
</tr>
<tr>
<td>UPDATE</td>
<td>/dogs/:id</td>
<td>PUT</td>
<td>update a dog</td>
</tr>
<tr>
<td>DESTROY</td>
<td>/dogs/:id</td>
<td>DELETE</td>
<td>delete a dog</td>
</tr>
</tbody></table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">&quot;/campgrounds/:id&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">  Campground.findById(req.params.id, <span class="function"><span class="keyword">function</span>(<span class="params">err, foundCampround</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      res.render(<span class="string">&quot;show&quot;</span>, &#123;<span class="attr">campground</span>:foundCampground&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> userSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">  email: <span class="built_in">String</span>,</span><br><span class="line">  name: <span class="built_in">String</span>,</span><br><span class="line">  posts: [postSchema]</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//then push() &amp; save() posts</span></span><br><span class="line"><span class="comment">//这种方法是embedded object，所有的post都是存在于user里面的</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//另一种方法，使用reference</span></span><br><span class="line"><span class="keyword">var</span> userSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">  email: <span class="built_in">String</span>,</span><br><span class="line">  name: <span class="built_in">String</span>,</span><br><span class="line">  posts: [</span><br><span class="line">    &#123;</span><br><span class="line">      type: mongoose.Schema.Types.ObjectId,</span><br><span class="line">      ref: <span class="string">&quot;Post&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">User.create(&#123;</span><br><span class="line">  name: <span class="string">&quot;Bob&quot;</span>,</span><br><span class="line">  email: <span class="string">&quot;bob@gmail.com&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Post.create(&#123;</span><br><span class="line">    title: <span class="string">&quot;How to cook the best burger&quot;</span>,</span><br><span class="line">  content: <span class="string">&quot;blah blah blah&quot;</span></span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err, post</span>)</span>&#123;</span><br><span class="line">  User.findOne(&#123;<span class="attr">email</span>: <span class="string">&quot;bob@gmail.com&quot;</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err, foundUser</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      foundUser.posts.push(post);</span><br><span class="line">      foundUser.save(<span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">          <span class="built_in">console</span>.log(err);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="built_in">console</span>.log(data);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过这种方法，post里面不仅仅是一个post id，而是具体的posts</span></span><br><span class="line">User.findOne(&#123;<span class="attr">email</span>: <span class="string">&quot;bob@gmail.com&quot;</span>&#125;).populate(<span class="string">&quot;post&quot;</span>).exec(<span class="function"><span class="keyword">function</span>(<span class="params">err, user</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(err)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(user);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>删库跑路 db.collection.drop() 写在命令行里</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href &#x3D; &quot;&#x2F;campgrounds&#x2F; &lt;%&#x3D; campground._id %&gt;&quot;&gt;More Info &lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure>

<p>这个id是mongo产生的一个唯一的id</p>
<h2 id="Module-Export"><a href="#Module-Export" class="headerlink" title="Module Export"></a>Module Export</h2><p>当我们在把文件分离开的时候，可以用require来获取其他js里的内容，这个时候需要我们explicit export内容，不然require也不会获取到任何东西</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">&quot;mongoose&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> postSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">  title: <span class="built_in">String</span>,</span><br><span class="line">  content: <span class="built_in">String</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//关键</span></span><br><span class="line"><span class="built_in">module</span>.exports = mongoose.model(<span class="string">&quot;Post&quot;</span>, postSchema);</span><br></pre></td></tr></table></figure>

<p>在另一个js文件里</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// “./” 意味着当前地址</span></span><br><span class="line"><span class="keyword">var</span> Post = <span class="built_in">require</span>(<span class="string">&quot;./models/post&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Seeding-the-database"><a href="#Seeding-the-database" class="headerlink" title="Seeding the database"></a>Seeding the database</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">seedDB</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    Campground.remove(&#123;&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err)&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;remove campgrounds!&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = seedDB;</span><br></pre></td></tr></table></figure>

<p>另一个js文件里调用seed</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> seedDB = <span class="built_in">require</span>(<span class="string">&quot;./models/seedDB&quot;</span>);</span><br><span class="line"></span><br><span class="line">seedDB();</span><br></pre></td></tr></table></figure>

<h2 id="使用额外的css"><a href="#使用额外的css" class="headerlink" title="使用额外的css"></a>使用额外的css</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.use(express.static(__dirname + <span class="string">&quot;/public&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>在header.ejs里面添加</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span> = <span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span> = <span class="string">&quot;/stylesheets/main.css&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h2><p>session就是让http request从stateless变得有state。它的作用很大程度上就是让用户得以登陆并看到特定的与之相关的内容，当用户logout的时候他们将不再能够看到这些内容。（将特定内容和用户登陆这一state绑定，在发送请求的时候实质上是XXX向服务器发起了这一请求）</p>
<p>Passport JS + Express-Session</p>
<blockquote>
<p>npm init</p>
<p>npm install bodu-parser express express-session mongoose passport passport-local passport-local-mongoose</p>
</blockquote>
<h2 id="User-Authentication-一个需要登录才能看到的秘密网页"><a href="#User-Authentication-一个需要登录才能看到的秘密网页" class="headerlink" title="User Authentication 一个需要登录才能看到的秘密网页"></a>User Authentication 一个需要登录才能看到的秘密网页</h2><p>app.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>),</span><br><span class="line">    mongoose = reuiqre(<span class="string">&quot;mongoose&quot;</span>),</span><br><span class="line">    passport = <span class="built_in">require</span>(<span class="string">&quot;passport&quot;</span>),</span><br><span class="line">    bodyParser = <span class="built_in">require</span>(<span class="string">&quot;body-parser&quot;</span>),</span><br><span class="line">    User = <span class="built_in">require</span>(<span class="string">&quot;./models/user&quot;</span>),</span><br><span class="line">    localStrategy = <span class="built_in">require</span>(<span class="string">&quot;passport-local&quot;</span>),</span><br><span class="line">    passportLocalMongoose = <span class="built_in">require</span>(<span class="string">&quot;passport-local-mongoose&quot;</span>);</span><br><span class="line"></span><br><span class="line">app.use(bodyParser.urlencoded(&#123;<span class="attr">extended</span>: <span class="literal">true</span>&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">//==passport configuration==</span></span><br><span class="line">app.use(<span class="built_in">require</span>(<span class="string">&quot;express-session&quot;</span>)(&#123;</span><br><span class="line">  secret: <span class="string">&quot;Rusty is the best&quot;</span>,</span><br><span class="line">  resave: <span class="literal">false</span>,</span><br><span class="line">  saveUninitialized: <span class="literal">false</span></span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">app.use(passport.initialize());</span><br><span class="line">app.use(passport.session());</span><br><span class="line"></span><br><span class="line">passport.use(<span class="keyword">new</span> LocalStrategy(User.authenticate()));<span class="comment">//authenticate() 是 passport-local-mongoose 带来的功能</span></span><br><span class="line">passport.serializeUser(User.serializeUser());</span><br><span class="line">passport.deserializeUser(User.deserializeUser());</span><br><span class="line"></span><br><span class="line"><span class="comment">//增加中间件 isLoggedIn 如果不是登陆的用户，就重定向</span></span><br><span class="line">app.get(<span class="string">&quot;/secret&quot;</span>, isLoggedIn, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">  res.render(<span class="string">&quot;secret&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//==注册==</span></span><br><span class="line">app.post(<span class="string">&quot;/register&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">  User.register(<span class="keyword">new</span> User(&#123;<span class="attr">username</span>: req.body.username&#125;), req.body.password, <span class="function"><span class="keyword">function</span>(<span class="params">err, user</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(err)&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(err);</span><br><span class="line">      <span class="keyword">return</span> res.render(<span class="string">&quot;register&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    passport.authenticate(<span class="string">&quot;local&quot;</span>)(req, res, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      res.redirect(<span class="string">&quot;/secret&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//这里post的第二个参数是middleware中间件。中间件是马上运行的，最后一个是callback，在运行完成后才会运行。</span></span><br><span class="line"><span class="comment">//==登陆==</span></span><br><span class="line">app.post(<span class="string">&quot;/login&quot;</span>, passport.authenticate(<span class="string">&quot;local&quot;</span>,  &#123;</span><br><span class="line">         successRedirect: <span class="string">&quot;/secret&quot;</span>, </span><br><span class="line">         failureRedirect: <span class="string">&quot;/login&quot;</span></span><br><span class="line">&#125;), <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//==登出==</span></span><br><span class="line">app.get(<span class="string">&quot;/logout&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">  req.logout();<span class="comment">//删除req的session所有的内容</span></span><br><span class="line">  res.redirect(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//标准的middleware需要这三个参数，next是下一个callback方程</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isLoggedIn</span>(<span class="params">req, res, next</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(req.isAuthenticated())&#123;</span><br><span class="line">    <span class="keyword">return</span> next();</span><br><span class="line">  &#125;</span><br><span class="line">  res.redirect(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>user.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">&quot;mongoose&quot;</span>),</span><br><span class="line">    passportLOcalMongoose = <span class="built_in">require</span>(<span class="string">&quot;passport-local-mongoose&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> UserSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">  username:<span class="built_in">String</span>,</span><br><span class="line">  password: <span class="built_in">String</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">UserSchema.plugin(passportLocalMongoose);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = mongoose.model(<span class="string">&quot;User&quot;</span>, UserSchema);</span><br></pre></td></tr></table></figure>

<h2 id="YelpCamp-User-Authentication"><a href="#YelpCamp-User-Authentication" class="headerlink" title="YelpCamp User Authentication"></a>YelpCamp User Authentication</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//因此我们使用一个middleware来替代手动的添加</span></span><br><span class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>)</span>&#123;</span><br><span class="line">  res.locals.currentUser = req.user;</span><br><span class="line">  next();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">&quot;/campground&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">    Campground.find(&#123;&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err, allCampground</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err)&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      res.render(<span class="string">&quot;campground/index&quot;</span>, &#123;<span class="attr">campgrounds</span>: allCampgrounds, <span class="attr">currentUser</span>: req.user&#125;); <span class="comment">//我们需要这个currentUser:req.user出现在所有的route里面因为我们所有的网页都带有这一个nav bar</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;% if (!currentUser)&#123; %&gt;</span><br><span class="line">    &lt;li&gt;&lt;a href &#x3D; &quot;&#x2F;login&quot;&gt;Login&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;</span><br><span class="line">  &lt;li&gt;&lt;a href &#x3D; &quot;&#x2F;register&quot;&gt;Sign up&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;</span><br><span class="line">&lt;% &#125;else&#123; %&gt;</span><br><span class="line">  &lt;li&gt;&lt;a&gt;Signed in as &lt;%&#x3D; currentUser.username %&gt;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;</span><br><span class="line">  &lt;li&gt;&lt;a href &#x3D; &quot;&#x2F;logout&quot;&gt;Logout&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Refactor"><a href="#Refactor" class="headerlink" title="Refactor"></a>Refactor</h2><p>将不同的route分成单独的文件：campground，comments，index（auth）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="string">&quot;/&quot;</span>, indexRoutes);</span><br><span class="line">app.use(<span class="string">&quot;/campgrounds&quot;</span>, campgroundRoutes);</span><br><span class="line">app.use(<span class="string">&quot;/campgrounds/:id/comments&quot;</span>, commentsRoutes);</span><br></pre></td></tr></table></figure>

<p>实际的route</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.Router(&#123;<span class="attr">mergeParams</span>: <span class="literal">true</span>&#125;);</span><br><span class="line"><span class="comment">//使用router代替所有的app</span></span><br></pre></td></tr></table></figure>

<p>改变comment的author name架构</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> commentSchema = monggose.Schema(&#123;</span><br><span class="line">  text: <span class="built_in">String</span>,</span><br><span class="line">  author: &#123;</span><br><span class="line">    id: &#123;</span><br><span class="line">      type: mongoose.Schema.Types.ObjectId,</span><br><span class="line">      ref: <span class="string">&quot;User&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    username: <span class="built_in">String</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">comment.author.id = req.user._id;</span><br><span class="line">comment.author.username = req.user.username;</span><br><span class="line">comment.save();</span><br><span class="line">campground.comments.push(comment);</span><br><span class="line">campground.save();</span><br></pre></td></tr></table></figure>

<h2 id="method-override"><a href="#method-override" class="headerlink" title="method override"></a>method override</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.use(methodOverride(<span class="string">&quot;_method&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>PUT</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;% if (currentUser &amp;&amp; campground.author.id.equals(currentUser._id))&#123; %&gt;&lt;!--存在且是创建者--&gt;</span><br><span class="line">    &lt;form action &#x3D; &quot;&#x2F;campgrounds&#x2F;&lt;%&#x3D; campground._id %&gt;?_method&#x3D;PUT&quot; method&#x3D;&quot;POST&quot;&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">    &lt;form action &#x3D; &quot;&#x2F;campgrounds&#x2F;&lt;%&#x3D; campground._id %&gt;?_method&#x3D;DELETE&quot; method&#x3D;&quot;POST&quot;&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">router.put(<span class="string">&quot;/:id&quot;</span>, checkCampgroundOwnership, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line"> Campground.findByIdAndUpdate(req.params.id, req.body.campground, <span class="function"><span class="keyword">function</span>(<span class="params">err, updatedCampground</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err)&#123;</span><br><span class="line">      res.redirect(<span class="string">&quot;/campgrounds&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      res.redirect(<span class="string">&quot;/campgrounds/&quot;</span> + req.params.id);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.delete(<span class="string">&quot;/:id&quot;</span>, checkCampgroundOwnership, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line"> Campground.findByIdAndRemove(req.params.id, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err)&#123;</span><br><span class="line">      res.redirect(<span class="string">&quot;/campgrounds&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      res.redirect(<span class="string">&quot;/campground&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkCampgroundOwnership</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (req.isAuthenticated())&#123;</span><br><span class="line">    Campground.findById(req.params.id, <span class="function"><span class="keyword">function</span>(<span class="params">err, foundCampground</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        res.redirect(<span class="string">&quot;back&quot;</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (foundCampground.author.is.equals(req.user._id))&#123;</span><br><span class="line">          next();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          res.send(<span class="string">&quot;You do not have permission!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.redirect(<span class="string">&quot;back&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//所谓的back就是说当前的页面的再刷新</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#delete-form</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline;<span class="comment">/*因为form不是inline，所以我们写一个css将button放在同一行的时候需要这样写*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>隐藏edit和delete按钮</li>
<li>阻止非创建用户使用按钮的功能</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//如果我们将要require的文件命名为index.js，我们直接require所在的文件夹就行，因为会默认寻找这个文件</span></span><br><span class="line"><span class="keyword">var</span> middleware = <span class="built_in">require</span>(<span class="string">&quot;../middleware&quot;</span>);</span><br><span class="line"><span class="comment">//实际上是在使用 middleware/index.js</span></span><br></pre></td></tr></table></figure>

<h2 id="Flash-Message"><a href="#Flash-Message" class="headerlink" title="Flash Message"></a>Flash Message</h2><p>show it once</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flash = <span class="built_in">require</span>(<span class="string">&quot;connect-flash&quot;</span>);</span><br><span class="line"></span><br><span class="line">app.use(flash());</span><br></pre></td></tr></table></figure>

<p>在需要的地方</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">req.flash(<span class="string">&quot;error&quot;</span>, <span class="string">&quot;Please login first&quot;</span>);</span><br><span class="line"><span class="comment">//在redirect前flash，而且flash会实际发生在redirect的网页上</span></span><br><span class="line">res.redirect(<span class="string">&quot;/login&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>)</span>&#123;</span><br><span class="line">  res.locals.currentUser = req.user;</span><br><span class="line">  res.locals.error = req.flash(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">  res.locals.success = req.flash(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">  next();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.get(<span class="string">&quot;/login&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">  res.render(<span class="string">&quot;login&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;% if (error &amp;&amp; error.length &gt; 0)&#123; %&gt;</span><br><span class="line">&lt;div class &#x3D; &quot;alert alert-danger&quot; role &#x3D; &quot;alert&quot;&gt;</span><br><span class="line">  &lt;%&#x3D; error %&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br><span class="line">&lt;% if (success &amp;&amp; success.length &gt; 0)&#123; %&gt;</span><br><span class="line">&lt;div class &#x3D; &quot;alert alert-success&quot; role &#x3D; &quot;alert&quot;&gt;</span><br><span class="line">  &lt;%&#x3D; success %&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">req.flash(<span class="string">&quot;error&quot;</span>, err.message);</span><br><span class="line"><span class="comment">//利用已有的 err 的 message</span></span><br></pre></td></tr></table></figure>

<h2 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h2><p>在需要git的文件夹内，运行命令行</p>
<blockquote>
<p>git init</p>
</blockquote>
<p>如果运行 git status，我们会得到</p>
<blockquote>
<p>on branch master 意味着我们是master</p>
<p>Untracked files:</p>
</blockquote>
<p>git不会自动把所在的文件夹里的所有文件track。使用git add来添加需要track的文件。每一次更改文件，我们都需要将更改的文件重新add一次，因为commit的文件是刚刚add的文件</p>
<blockquote>
<p>git add app.js</p>
</blockquote>
<p>-m 提示要添加commit信息</p>
<blockquote>
<p>git commit -m “add app.js file”</p>
</blockquote>
<p>一个.意味着添加所有not staged changed file</p>
<blockquote>
<p>git add .</p>
</blockquote>
<p>所有的commit记录</p>
<blockquote>
<p>git log</p>
</blockquote>
<p>我们回看某一个commit的状态，只是回看所以master仍然停留在原位，我们现在是Head在前面</p>
<blockquote>
<p>git checkout (xxx-id)</p>
</blockquote>
<p>程序员很少直接revert回很早之前的地方，不过也有这样的代码，善用谷歌</p>
<h2 id="Deployment"><a href="#Deployment" class="headerlink" title="Deployment"></a>Deployment</h2><p>在命令行中使用 Heroku</p>
<blockquote>
<p>heroku login -i</p>
<p>填写邮件和密码信息</p>
</blockquote>
<p>使用git init，git add 和 git commit来做好准备，之后</p>
<blockquote>
<p>heroku create</p>
</blockquote>
<p>这个时候 heroku 只是知道我们想要创建一个 app，但是具体的内容还是不清楚的。</p>
<blockquote>
<p>git remote -v</p>
<p>git push heroku master</p>
</blockquote>
<p>debug heroku，我们缺失了start.js因为在cloud9里面我们是通过node app.js启动的，但是单纯上传所有的文件并不能做到这些。</p>
<blockquote>
<p>heroku logs</p>
</blockquote>
<p>我们需要在package.json里添加</p>
<blockquote>
<p>“scripts”: {</p>
<p>​    “start”: “node app.js”</p>
<p>}</p>
</blockquote>
<p>我们可以使用 heroku run ls来命令远程的heroku运行一些命令行</p>
<h2 id="MongoLab"><a href="#MongoLab" class="headerlink" title="MongoLab"></a>MongoLab</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mongoose.connect(<span class="string">&quot;mongodb://localhost/yelp_camp&quot;</span>);</span><br><span class="line"><span class="comment">//更改成mongolab的形式，登陆后自网站上获取</span></span><br><span class="line">mongoose.connect(<span class="string">&quot;mongodb://#username:#password@ds055525.mongolab.com:55525/yelpcamp&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>在cloud9的命令行里输入</p>
<blockquote>
<p>export DATABASEURL=mongodb://localhost/yelp_camp</p>
</blockquote>
<p>在heroku更改”Settings -&gt; Config Variables -&gt; KEY &amp; VALUE”</p>
<p>然后把上面的代码改成</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> url = process.env.DATABASEURL || <span class="string">&quot;mongodb://localhost/yelp_camp&quot;</span>;</span><br><span class="line"><span class="comment">//第二个是在参数不存在的时候给一个hard code 来避免报错</span></span><br><span class="line">mongoose.connect(url);</span><br></pre></td></tr></table></figure>

<p>这样的话，即使我们将这个packge开源，别人也不会知道我的mongolab的数据库里的账号密码。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/04/BackEnd-notes/" data-id="ckdfdtzl400010vqv9iuuh3nr" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-FrontEnd-notes" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/08/04/FrontEnd-notes/" class="article-date">
  <time datetime="2020-08-04T03:25:58.000Z" itemprop="datePublished">2020-08-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/08/04/FrontEnd-notes/">FrontEnd notes</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Front-End-VS-Back-End"><a href="#Front-End-VS-Back-End" class="headerlink" title="Front End VS Back End"></a>Front End VS Back End</h2><ol>
<li>Front End: see and interact: HTML, CSS, JS</li>
<li>Back End: everything else</li>
<li>像一个餐厅：backend是厨房，frontend是摆盘和服务员</li>
</ol>
<p>static page/ dynamic page (javascript)</p>
<blockquote>
<p>html 规定了网页的skeleton，最低限度的美观</p>
<p>css 是皮肤，给html装上不同的装扮</p>
<p>javascript是用于各种不同的交互的（比如button的响应）</p>
</blockquote>
<h2 id="HTML-file"><a href="#HTML-file" class="headerlink" title="HTML file"></a>HTML file</h2><p>每个html都应该有的东西，DOCTYPE，head（title），body</p>
<p>title的作用是用于搜索引擎索引和浏览器的tab</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Metadata here --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--Content--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们可以看到<b>是一个inline tag而<p>是一个blcok tag。当然，现在我们已经不用<b>这种过时的方法了，它还可以用，但是已经不再流行，可以用<strong>来代替。就正如<i>被<em>（emphasis）代替一样，因为他给我带来了更多一点点的meaning而不是单纯的改变格式。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>red<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>blue<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在写tag的时候，可以写li然后摁一下tab键，电脑会自动补全前后两个</p>
<p>div和span的区别，span是inline的container，div是一个block的container。我们可以把多个不同的elements组合在一起，比如说在他们的背后加上相同的背景这样的工作。</p>
<h2 id="Attributes"><a href="#Attributes" class="headerlink" title="Attributes"></a>Attributes</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;pic1.png&quot;</span>&gt;</span> <span class="comment">&lt;!--单边的，在里面用=给attribute赋值--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span> = <span class="string">&quot;url&quot;</span>&gt;</span> link text<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="comment">&lt;!--这里的url需要指定protocol，比如说http的例子：http://www.google.com/。因为不指定的话，他就会认为是同一个local地址下的内容--&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Table"><a href="#Table" class="headerlink" title="Table"></a>Table</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="comment">&lt;!--这个是row--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>Head1<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="comment">&lt;!--这个是head--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>Head2<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="comment">&lt;!--这个是row--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>Red<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="comment">&lt;!--这个是cell--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>Orange<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>Yellow<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>Green<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Form"><a href="#Form" class="headerlink" title="Form"></a>Form</h2><p>谷歌，登陆facebook都需要form去和database交互</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--action where form data send data to--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--method HTTP method get/ post--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span> = <span class="string">&quot;/sign-in-url&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--all inputs here, name = 提交的内容的名字，type是在html上显示的样式，placeholder是占位符--&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;firstName&quot;</span>&gt;</span>First Name: <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span> = <span class="string">&quot;firstName&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">required</span>&gt;</span><span class="comment">&lt;!--使用text就是明文的，password会用点点隐藏输入的内容--&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span> = <span class="string">&quot;email&quot;</span>&gt;</span>Email:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span> = <span class="string">&quot;email&quot;</span> <span class="attr">type</span> = <span class="string">&quot;email&quot;</span> <span class="attr">placeholder</span> = <span class="string">&quot;email&quot;</span>&gt;</span><span class="comment">&lt;!--类型email会使得浏览器检查输入是否合法--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span> = <span class="string">&quot;password&quot;</span>&gt;</span>Username:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span> = <span class="string">&quot;Password&quot;</span> <span class="attr">id</span> = <span class="string">&quot;Password&quot;</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">pattern</span> = <span class="string">&quot;.&#123;5, 10&#125;&quot;</span> <span class="attr">required</span> <span class="attr">title</span> = <span class="string">&quot;Password must be between 5 to 10 characters&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--require意味着浏览器会检查这里是否为空，pattern意味着长度的限制，required title会提醒错误的原因--&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Do you prefer cats or dogs?<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span> = <span class="string">&quot;dogs&quot;</span>&gt;</span>Dogs: <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span> = <span class="string">&quot;petChoice&quot;</span> <span class="attr">id</span> = <span class="string">&quot;dogs&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">value</span> = <span class="string">&quot;dogs&quot;</span>&gt;</span><span class="comment">&lt;!--开了之后不能再关，只有一个选项的东西--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span> = <span class="string">&quot;cats&quot;</span>&gt;</span>Cats: <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span> = <span class="string">&quot;petChoice&quot;</span> <span class="attr">id</span> = <span class="string">&quot;cats&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">value</span> = <span class="string">&quot;cats&quot;</span>&gt;</span><span class="comment">&lt;!--因为用了同一个name，所以html知道用户只能选一个，value的作用是在按下最后一个button的时候传递这个选项真正的值--&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>what is your favorite color?<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span> = <span class="string">&quot;color&quot;</span>&gt;</span> <span class="comment">&lt;!--这个是选项在传输的时候的名字--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span> = <span class="string">&quot;R&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span>Red<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span> = <span class="string">&quot;O&quot;</span>&gt;</span>Orange<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span> = <span class="string">&quot;Y&quot;</span>&gt;</span>Yellow<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="comment">&lt;!--value是我们想要在传输的时候的值--&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span> = <span class="string">&quot;paragraph&quot;</span> <span class="attr">row</span> = <span class="string">&quot;10&quot;</span> <span class="attr">col</span> = <span class="string">&quot;50&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">checked</span>&gt;</span><span class="comment">&lt;!--可以select和deselect的功能--&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span>&gt;</span></span><br><span class="line">    Login</span><br><span class="line">  <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><p>找颜色的时候，用hex的方式写出来，默认的颜色方案几乎没有人用，使用color picker就行。rgba里的a是0～1的。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h1</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#FF0000</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>, .<span class="number">6</span>);</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">56</span>fx;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">100</span>, <span class="number">80</span>);</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">url</span>(http://www.eason.com/);</span><br><span class="line">  <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">  <span class="attribute">background-size</span>: cover;</span><br><span class="line">  <span class="attribute">border-color</span>: purple;</span><br><span class="line">  <span class="attribute">border-width</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">border-style</span>: solid;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">5px</span> solid purple; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>1 我们可以把css写到html里面，就像一个inline的attribute一样 style=“color：purple;”。非常不推荐这样，费时费力的同时还把内容和格式搅和在一起。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">sytle</span> <span class="attr">type</span> = <span class="string">&quot;text.css&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--2. html里的放css的用法--&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">sytle</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--分离的做法：推荐！href是css文件的地方--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span> = <span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span> = <span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;app.css&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--使用google fonts--&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;https://fonts.googleapis.com/css2?family=Indie+Flower&amp;family=Raleway&amp;display=swap&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>id &amp; class</strong></p>
<p>在html里加上class = “highlight” 或者 id = “special”</p>
<p>在css里加上</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#special</span>&#123;</span><br><span class="line">    <span class="comment">/*id*/</span></span><br><span class="line">&#125;</span><br><span class="line">. <span class="selector-tag">highlight</span> &#123;</span><br><span class="line">    <span class="comment">/*class*/</span></span><br><span class="line">  <span class="attribute">text-decoration</span>: line-through;</span><br><span class="line">&#125;</span><br><span class="line">* &#123;</span><br><span class="line">  <span class="comment">/*全选*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">li</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="comment">/*所有的在 li 的 a*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">h4</span> + <span class="selector-tag">ul</span>&#123;</span><br><span class="line">  <span class="comment">/*并列的，有先后顺序的*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">input</span> <span class="selector-attr">[type=<span class="string">&quot;checkbox&quot;</span>]</span>&#123;</span><br><span class="line">  <span class="comment">/*attribute selector*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">ul</span><span class="selector-pseudo">:nth-of-type(3)</span>&#123;</span><br><span class="line">  <span class="comment">/*选第三个*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>css的逻辑：从上往下跑，所以最后出现的改动会覆盖前面的。另外所有的元素都会继承更大的部分，比如所有元素之于body，li之于ul。css specification的优先级是：id &gt; class &gt; li &gt; ul 越具体的优先级越高。specificity calculator 可以计算。</p>
<p><strong>fonts</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">font-family</span>: Arial;</span><br><span class="line">  <span class="attribute">line-height</span>:<span class="number">2</span>;<span class="comment">/*两倍行距*/</span></span><br><span class="line">  <span class="attribute">text-decoration</span>: underline;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="comment">/*span是用于highlight一部分，也就是inline的一种选择*/</span></span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">2.0em</span>;</span><br><span class="line">  <span class="comment">/*两倍大小于默认大小，可以先设置body的font size，这样我们就可以知道“默认”有多大*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">h1</span>&#123;</span><br><span class="line">  <span class="attribute">font-weight</span>: bold;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">100</span>~<span class="number">800</span>; <span class="comment">/*只有一部分的字体提供整百粗细的调整*/</span></span><br><span class="line">  <span class="attribute">text-align</span>: center; <span class="comment">/*中心对齐*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">  he is a <span class="tag">&lt;<span class="name">span</span>&gt;</span>student!<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>![截屏2020-06-20下午7.27.05](/Users/easonchiu/Library/Application Support/typora-user-images/截屏2020-06-20下午7.27.05.png)</p>
<p>调节padding可以调整border到element的距离，margin是调节element之间的距离。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50%</span>;<span class="comment">/*50%的parent element width*/</span></span><br><span class="line">  <span class="attribute">border</span>: <span class="number">2px</span> solid blue;<span class="comment">/*如果不具体指定的话，那么border的宽度将会是屏幕的宽度，这是被p元素所定义的*/</span></span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto <span class="number">0</span> auto; <span class="comment">/*居中*/</span></span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto; <span class="comment">/*居中*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>九宫格的实现</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span> = <span class="string">&quot;text/css&quot;</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    table &#123;</span><br><span class="line"><span class="css">      <span class="selector-tag">margin</span>: <span class="selector-tag">auto</span>; <span class="comment">/**居中**/</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    td &#123;</span><br><span class="line">      width: 100px;</span><br><span class="line">      height: 100px;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="css">    <span class="selector-class">.vertical</span>&#123;</span></span><br><span class="line">      border-left: 1px solid black;</span><br><span class="line">      border-right: 1px solid black;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="css">    <span class="selector-class">.horizontal</span>&#123;</span></span><br><span class="line">      border-top: 1px solid black;</span><br><span class="line">      border-botton: 1px solid black;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span> = <span class="string">&quot;vertical&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span> = <span class="string">&quot;horizontal&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span> = <span class="string">&quot;vertical horizontal&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span> <span class="comment">&lt;!--有多个class的时候用空格分开--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span> = <span class="string">&quot;horizontal&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span> = <span class="string">&quot;vertical&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="BootStrap"><a href="#BootStrap" class="headerlink" title="BootStrap"></a>BootStrap</h2><p>几个值得注意的点</p>
<ol>
<li>对于button来说，我们只要简单地加上class = “btn btn-success active”这样的class，就能拥有很好看的button外观。</li>
<li>可以使用Jumbotron来突出显示一些内容</li>
<li>利用form-group和form-control，可以让表单的外观更为好看</li>
<li>Grid ；12</li>
<li>有四种设备屏幕大小：col-xs-, .col-sm-, col-md-, .col-lg-分别代表了extra small，small，medium，large</li>
</ol>
<h2 id="BootStrap-4-0-值得关注的新功能"><a href="#BootStrap-4-0-值得关注的新功能" class="headerlink" title="BootStrap 4.0 值得关注的新功能"></a>BootStrap 4.0 值得关注的新功能</h2><ol>
<li>card</li>
<li>dropdown有改变</li>
<li>color：class=”text-primary”, “text-warning”…</li>
<li>display-1, 2, 3, 4 非常大的默认字体，对应的是按比例的6rem</li>
<li>/<blockquote class="blockquote"> &amp; <blockquote class="blockquote text-right"></li>
<li>/<h5 class="border border-danger rounded-top"> 红圆上 &amp;<h5 class="border border-left-0 border-warning"> 黄无左</li>
<li>/<button class="btn btn-info p-0"> p-1, p-2, p-3, p-4, p-5 越来越大的padding。还有指定哪一条边 <button class="btn btn-info pt-5"></li>
<li>/<p class="bg-success text-white m-0">m-0 ～ m-5</li>
<li>Break Points：/<button class="btn btn-warning p-sm-5 p-md-0 p-lg-5 p-xl-0"> 从xs开始屏幕变大：按键的padding小大小大小。</li>
<li>/<button class="btn btn-primary p-4 mx-0 mx-sm-2 mx-md-3 mx-lg-4 mx-xl-5"> 调整margin</li>
<li>nav有改变：要指定背景的颜色了，还要指定什么时候expand小汉堡</li>
<li>/<h1 class="d-xl-none"> xl的时候隐藏</li>
<li><strong>FlexBox</strong>是一种positioning的技术，一般来说就是使得内容能够在box里放置在具体的位置（<strong>justified content</strong>-）center/ between/ end/ around（main access 从左到右）</li>
<li><strong>align-items</strong>-start（从上到下）-center/ -end</li>
<li>flex-row-reverse（从右到左）flex-column（以列为主要的方向）</li>
<li>在nav这样的组件里面已经默认使用了flex，可以做自适应，还有tab </li>
<li><strong>align-self</strong>-start：单独控制的override</li>
<li>order-md-2</li>
</ol>
<h2 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h2><ol>
<li>引号的使用：单引双引都可以，但是如果我们要在string里面使用引号就要用另一种引号或者用\转义，要打\的时候用\转义就行</li>
<li>String可以相加，concatenation</li>
<li>可以”hello”[0] = “h” “hi\（\）”.length = 3</li>
<li>var name = “Rusty”</li>
<li>Declared but not initialized: var age; undefined</li>
<li>explicitly empty: currentPlayer = null;</li>
<li>// 在js里是comment的意思</li>
<li>clear() console</li>
<li>alert(“Hello There”);</li>
<li>console.log(213123);</li>
<li>var userName = prompt(“what is your name?”) pop up windowns and get answer</li>
<li>script的位置就是它们运行的先后顺序，如果放在head，那它会在html的实际内容运行之前运行</li>
<li>=== 类型和内容相同 5 == “5” true == “1” 0 == false null == undefined (NaN == NaN) = false</li>
<li>对于“”，null，0，NaN，undefined来说是false，对于任何有实质内容的string都是true，即使是“false”也是true</li>
<li>while (conditional statement){}</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num = <span class="number">-10</span>;</span><br><span class="line"><span class="keyword">while</span> (num &lt; <span class="number">20</span>)&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(num);</span><br><span class="line">  num++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">num = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">while</span> (num &lt;= <span class="number">40</span>)&#123;</span><br><span class="line">  <span class="keyword">if</span> (num % <span class="number">2</span> == <span class="number">0</span>)&#123;</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> count = <span class="number">0</span>; count &lt; <span class="number">6</span>; count++)&#123;</span><br><span class="line">  <span class="comment">//for loop count is not global as while loop</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hi</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//在JS里，如果你在调用方程的时候没有给出argument的话，程序会给他们undefined，继续运行</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;hi there&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">setInterval</span>(aFunc, <span class="number">1000</span>); <span class="comment">//每一秒运行一次aFunc，注意这里不用加上括号</span></span><br><span class="line"><span class="built_in">setInterval</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;This is anonymous function&quot;</span>);</span><br><span class="line">&#125;);<span class="comment">//匿名方程，只用一次的方程</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> friends = [<span class="string">&quot;Charlie&quot;</span>, <span class="string">&quot;Liz&quot;</span>, <span class="string">&quot;David&quot;</span>, <span class="string">&quot;Mattias&quot;</span>];</span><br><span class="line">friends[<span class="number">4</span>] = <span class="string">&quot;Amelie&quot;</span>;<span class="comment">//增加新的</span></span><br><span class="line">friends.push(<span class="string">&quot;Amelie&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> friend = colors.pop();</span><br><span class="line">friends.unshift(<span class="string">&quot;Eason&quot;</span>);<span class="comment">//加在最前面</span></span><br><span class="line">friends.shift(<span class="string">&quot;Sherry&quot;</span>);<span class="comment">//加在最后面</span></span><br><span class="line">friends.indexOf(<span class="string">&quot;Eason&quot;</span>);<span class="comment">//不存在的话就是-1</span></span><br><span class="line"><span class="keyword">var</span> subFriends = slice(<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line">friends.splice(index, <span class="number">1</span>);<span class="comment">//从哪里开始删除，删几个？</span></span><br><span class="line"></span><br><span class="line">friends.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">friend</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(friend);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> friends = [];</span><br><span class="line"><span class="keyword">var</span> friends = <span class="keyword">new</span> <span class="built_in">Array</span>();<span class="comment">//不常用</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//New Object Approach 1 </span></span><br><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">  name: <span class="string">&quot;Cindy&quot;</span>,</span><br><span class="line">  age: <span class="number">32</span>,</span><br><span class="line">  city: <span class="string">&quot;Missoula&quot;</span>,</span><br><span class="line">  <span class="comment">//object里面也可以有function，使用它们等同于console.log();</span></span><br><span class="line">  add: <span class="function"><span class="keyword">function</span>(<span class="params">x, y</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//New Object Approach 2 </span></span><br><span class="line"><span class="keyword">var</span> person = &#123;&#125;;</span><br><span class="line">person.name = <span class="string">&quot;Travis&quot;</span>;</span><br><span class="line">person.age = <span class="number">21</span>;</span><br><span class="line">person.city = <span class="string">&quot;LA&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//New Object Approach 3</span></span><br><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">person.name = <span class="string">&quot;Travis&quot;</span>;</span><br><span class="line">person.age = <span class="number">21</span>;</span><br><span class="line">person.city = <span class="string">&quot;LA&quot;</span>;</span><br><span class="line"><span class="comment">//person.age 等同于 person[&quot;age&quot;]，注意这个双引号是必须的</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> movies = [</span><br><span class="line">  &#123;</span><br><span class="line">    titlew: <span class="string">&quot;In Bruges&quot;</span>,</span><br><span class="line">    hasWatched: <span class="literal">true</span>,</span><br><span class="line">    rating: <span class="number">5</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    title: <span class="string">&quot;Frozen&quot;</span>,</span><br><span class="line">    hasWatched: <span class="literal">false</span>,</span><br><span class="line">    rating: <span class="number">4.5</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"><span class="comment">//&quot;\&quot;&quot; = &quot; 因为前后两个双引号代表了string，第二个双引号前面用\转义告诉电脑不要在这里停下来</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//movies是一个装满了movie object的array，对每一个object进行forEach loop并通过anonymous function操作movie object</span></span><br><span class="line">movies.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">movie</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(buildString(movie));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>answer.indexOf(“yes”) == -1 意味着这个answer里面不含有yes这个子字符串</p>
<p>object 类似于 dictionary, key都是string</p>
<p>this有什么用，就是在object里面的function需要调用这一个object内部的数据的时候，需要加上this.data</p>
<h2 id="DOM-Document-Object-Model"><a href="#DOM-Document-Object-Model" class="headerlink" title="DOM (Document Object Model)"></a>DOM (Document Object Model)</h2><p>console.dir(document)可以看到javascript将html看作一个巨大的object</p>
<p>最重要的是养成一种心态：就是对于自己不知道所有的东西感到comfortable，因为html的内容是非常多的，不可能完全搞清楚所有的地方。</p>
<p><strong>select + manipulate</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> h1 = <span class="built_in">document</span>.querySelector(<span class="string">&quot;h1&quot;</span>); <span class="comment">//select</span></span><br><span class="line">h1.style.color = <span class="string">&quot;pink&quot;</span>; <span class="comment">//manipulate</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> isBlue = <span class="literal">false</span>;</span><br><span class="line"><span class="built_in">setInterval</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (isBlue)&#123;</span><br><span class="line">    h1.style.background = <span class="string">&quot;white&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">    h1.style.background = <span class="string">&quot;#3498db&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">  isBlue = !isBlue;</span><br><span class="line">&#125;, <span class="number">1000</span>); <span class="comment">//每一秒变换一下颜色</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&quot;highlight&quot;</span>); = <span class="built_in">document</span>.querySeletor(<span class="string">&quot;#highlight&quot;</span>); <span class="comment">//就是使用css selector来选择，只返回第一个符合条件的</span></span><br><span class="line"><span class="built_in">document</span>.getElementByClass();</span><br><span class="line"><span class="built_in">document</span>.getElementByTagName(); <span class="comment">//class可能会有成千上万的element有相同的tag比如说&lt;p&gt;</span></span><br><span class="line"><span class="built_in">document</span>.querySelectorAll(<span class="string">&quot;.bolded&quot;</span>);<span class="comment">//返回所有的，也可以用这个选择id，但是返回的是只有一个object的array</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//style</span></span><br><span class="line">h1.style.color = <span class="string">&quot;yellow&quot;</span>;</span><br><span class="line">h1.style.background = <span class="string">&quot;blue&quot;</span>;</span><br><span class="line">h1.style.border = <span class="string">&quot;5px solid pink&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//turn on/ off .css</span></span><br><span class="line">h1.classList.add(<span class="string">&quot;big&quot;</span>)</span><br><span class="line">h1.classList.remove(<span class="string">&quot;big&quot;</span>)</span><br><span class="line">h1.classList.toggle(<span class="string">&quot;big&quot;</span>)<span class="comment">//切换成关/开</span></span><br><span class="line">h1.textContent = <span class="string">&quot;blah&quot;</span>; <span class="comment">//用这种方法会override所有的inline tag</span></span><br><span class="line">h1.innerHtml = <span class="string">&quot;&lt;strong&gt;blah&lt;/strong&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> img = <span class="built_in">document</span>.getElementsbyTagName(<span class="string">&quot;img&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">img.setAttribute(<span class="string">&quot;src&quot;</span>, <span class="string">&quot;http://image.jpg&quot;</span>);</span><br><span class="line">a.setAttribute(<span class="string">&quot;href&quot;</span>, <span class="string">&quot;http://www.google.com&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> button = <span class="built_in">document</span>.querySelector(<span class="string">&quot;button&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> paragraph = <span class="built_in">document</span>.querySelector(<span class="string">&quot;p&quot;</span>);</span><br><span class="line">button.addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  paragraph.textContent = <span class="string">&quot;Button has been clicked!&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//学会使用&lt;span&gt;来inline选择一部分</span></span><br><span class="line"><span class="keyword">var</span> numInput = <span class="built_in">document</span>.querySelector(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">numInput.addEventListener(<span class="string">&quot;change&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  winningScoreDisplay.textContent = <span class="built_in">this</span>.value;<span class="comment">//.value是取出来的输入值</span></span><br><span class="line">  winningScore = <span class="built_in">Number</span>(<span class="built_in">this</span>.value); <span class="comment">//强制转换成数字</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">h1.addEventListener(<span class="string">&quot;mouseover&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.style.color = <span class="string">&quot;green&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line">h1.addEventListener(<span class="string">&quot;mouseout&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.style.color = <span class="string">&quot;white&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//this = h1 here</span></span><br></pre></td></tr></table></figure>

<p>在写网站的时候，要是用很小的sprint和task的思维，也就是小步快跑，每次都简化功能去尝试效果，不要想着毕其功于一役，直接跳到最终的版本。而是先做一些hard code，慢慢改进到最终版本。这样做的好处是随时有一个可用可看的版本，而且不会在最终的版本出错的时候，不知道错误可能出现在哪里。</p>
<h2 id="jQuery"><a href="#jQuery" class="headerlink" title="jQuery"></a>jQuery</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;img&quot;</span>) <span class="comment">//select all &lt;img&gt; tag</span></span><br><span class="line">$(<span class="string">&quot;.sale&quot;</span>) <span class="comment">//class sale</span></span><br><span class="line">$(<span class="string">&quot;#bonus&quot;</span>) <span class="comment">// id bonus</span></span><br><span class="line">$(<span class="string">&quot;li a&quot;</span>) <span class="comment">//all &lt;a&gt; tag inside li</span></span><br><span class="line"></span><br><span class="line">$(<span class="string">&quot;h1&quot;</span>).css(<span class="string">&quot;color&quot;</span>, <span class="string">&quot;yellow&quot;</span>); = <span class="built_in">document</span>.querySelector(<span class="string">&quot;h1&quot;</span>).style.color = <span class="string">&quot;yellowj&quot;</span>;</span><br><span class="line">$(<span class="string">&quot;div:first-of-type&quot;</span>).css(<span class="string">&quot;color&quot;</span>, <span class="string">&quot;pink&quot;</span>); = $(<span class="string">&quot;div:first&quot;</span>).css(<span class="string">&quot;color&quot;</span>, <span class="string">&quot;pink&quot;</span>); <span class="comment">//选择第一个div，后者是jQuery的方法，前者是css的，前者更快</span></span><br><span class="line"></span><br><span class="line">$(<span class="string">&quot;li&quot;</span>).text();<span class="comment">//返回所有的&lt;li&gt;内容，中间直接相连</span></span><br><span class="line">$(<span class="string">&quot;h1&quot;</span>).text(<span class="string">&quot;new text&quot;</span>); <span class="comment">//传参数的时候可以直接更改所显示的文字，而且是所有的h1</span></span><br><span class="line">$(<span class="string">&quot;ul&quot;</span>).html();<span class="comment">//返回&lt;ul&gt;的所有内容，html格式的</span></span><br><span class="line"></span><br><span class="line">$(<span class="string">&quot;img&quot;</span>).attr(<span class="string">&quot;src&quot;</span>, <span class="string">&quot;http://www.google.com&quot;</span>);<span class="comment">//改变单个attribute</span></span><br><span class="line">$(<span class="string">&quot;#greatphoto&quot;</span>).attr(&#123;</span><br><span class="line">  alt: <span class="string">&quot;Beijing Brush Seller&quot;</span>,</span><br><span class="line">  title: <span class="string">&quot;photo by Kelly Clark&quot;</span></span><br><span class="line">&#125;);<span class="comment">//一次调整多个attribute</span></span><br><span class="line"></span><br><span class="line">$(<span class="string">&quot;select&quot;</span>).val()<span class="comment">//从input/ select（dropdown）里取出内容</span></span><br><span class="line"></span><br><span class="line">$(<span class="string">&quot;h1&quot;</span>).addClass(<span class="string">&quot;correct&quot;</span>);</span><br><span class="line">$(<span class="string">&quot;h1&quot;</span>).removeClass(<span class="string">&quot;correct&quot;</span>);</span><br><span class="line">$(<span class="string">&quot;h1&quot;</span>).toggleClass(<span class="string">&quot;correct&quot;</span>);</span><br><span class="line"></span><br><span class="line">$(<span class="string">&quot;li&quot;</span>).first()<span class="comment">//首</span></span><br><span class="line">$(<span class="string">&quot;li&quot;</span>).last()<span class="comment">//尾</span></span><br><span class="line"></span><br><span class="line">$(<span class="string">&quot;button&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  $(<span class="built_in">this</span>).css(<span class="string">&quot;background&quot;</span>, <span class="string">&quot;pink&quot;</span>);<span class="comment">//.css()是一个jQuery method，所以我们要保证调用者也是一个jQuery object（$(this)）</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">.keydown()</span><br><span class="line">.keyup()</span><br><span class="line">.keypress()</span><br><span class="line"><span class="comment">//如果是shift + a = keypress()会得到A，而up/down只会得到摁键本身</span></span><br><span class="line">$(<span class="string">&quot;input&quot;</span>).keypress(<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (event.which === <span class="number">13</span>)&#123;</span><br><span class="line">    <span class="comment">//hit enter</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">on() 类似于 addEventListener()</span><br><span class="line">$(<span class="string">&#x27;button&#x27;</span>).on(<span class="string">&quot;mouseenter&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;);</span><br><span class="line">$(<span class="string">&#x27;button&#x27;</span>).on(<span class="string">&quot;mouseleave&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;);</span><br><span class="line">$(<span class="string">&#x27;button&#x27;</span>).on(<span class="string">&quot;dblclick&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;);</span><br><span class="line"></span><br><span class="line">$(<span class="string">&quot;button&quot;</span>).on(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  $(<span class="string">&quot;div&quot;</span>).fadeOut(<span class="number">1000</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    $(<span class="built_in">this</span>).remove();<span class="comment">//remove object after fade out</span></span><br><span class="line">  &#125;);<span class="comment">//1000ms = 1s</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//also .fadeIn() .slideToggle() .slideDown() .slideUp() 往下/往上收起</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/04/FrontEnd-notes/" data-id="ckdfdtzl500020vqv8u31bu6k" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Vue-js-note" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/08/04/Vue-js-note/" class="article-date">
  <time datetime="2020-08-04T02:12:39.000Z" itemprop="datePublished">2020-08-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/08/04/Vue-js-note/">Vue.js note</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Vue"><a href="#Vue" class="headerlink" title="Vue"></a>Vue</h2><p>React/ (Vue + Weex): can develop mobile app</p>
<p>Vue focus on V in “MVC” (font end page)</p>
<p>History: JS -&gt; JQuery (Improved compatibility with different browsers) -&gt; template engine (node.js + ejs, DOM manipulations, reload the whole page) -&gt; Angular/ Vue (AJAX, save unnecessary DOM manipulation automatically)</p>
<h2 id="Framework-vs-Library"><a href="#Framework-vs-Library" class="headerlink" title="Framework vs Library"></a>Framework vs Library</h2><p>Framework: a complete solution, can’t change it without painful loss (node.js express)<br>Library: very small and specific function, change it is very common and easy</p>
<h2 id="MVC-in-Backend"><a href="#MVC-in-Backend" class="headerlink" title="MVC in Backend"></a>MVC in Backend</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/04/Vue-js-note/" data-id="ckdfdtzku00000vqv7e1q9hpn" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-AWS-ToysHub" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/08/03/AWS-ToysHub/" class="article-date">
  <time datetime="2020-08-03T06:36:14.000Z" itemprop="datePublished">2020-08-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/08/03/AWS-ToysHub/">AWS-ToysHub</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="How-to-commit-to-Github-via-AWS-Cloud9"><a href="#How-to-commit-to-Github-via-AWS-Cloud9" class="headerlink" title="How to commit to Github via AWS Cloud9?"></a>How to commit to Github via AWS Cloud9?</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ git init</span><br><span class="line">$ git add</span><br><span class="line">$ git commit -m</span><br><span class="line">$ git remote add origin https:&#x2F;&#x2F;github.com&#x2F;YuxuanZhao&#x2F;ToysHub.git &#x2F;&#x2F;need it at the first time</span><br><span class="line">$ git push -u origin master</span><br></pre></td></tr></table></figure>

<h2 id="MongoDB-Command-Line-Control"><a href="#MongoDB-Command-Line-Control" class="headerlink" title="MongoDB Command Line Control"></a>MongoDB Command Line Control</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ mongo</span><br><span class="line">$ show dbs</span><br><span class="line">$ use toys_hub</span><br><span class="line">$ show collections</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C $ db.toys.insert(&#123;name: &quot;Zaku II&quot;, description: &quot;blah&quot;&#125;) </span><br><span class="line">R $ db.toys.remove(&#123;name: &quot;Zaku II&quot;&#125;)</span><br><span class="line">U $ db.toys.update(&#123;name: &quot;Zaku II&quot;&#125;, &#123;$set: (name: &quot;Zaku III&quot;, description: &quot;blah blah&quot;)&#125;) </span><br><span class="line">D $ db.toys.find(&#123;name: &quot;Zaku II&quot;&#125;) </span><br></pre></td></tr></table></figure>


<h2 id="use-req-body-in-express-need-bodyParser"><a href="#use-req-body-in-express-need-bodyParser" class="headerlink" title="use req.body in express need bodyParser"></a>use req.body in express need bodyParser</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bodyParser = <span class="built_in">require</span>(<span class="string">&quot;body-parser&quot;</span>);</span><br><span class="line">app.use(bodyParser.urlencoded(&#123;<span class="attr">extended</span>: <span class="literal">true</span>&#125;));</span><br></pre></td></tr></table></figure>


<h2 id="use-Mongoose"><a href="#use-Mongoose" class="headerlink" title="use Mongoose"></a>use Mongoose</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mongoose= <span class="built_in">require</span>(<span class="string">&quot;mongoose&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//connect to mongo database</span></span><br><span class="line">mongoose.connect(<span class="string">&quot;mongodb://localhost/toys_hub&quot;</span>, &#123;<span class="attr">useNewUrlParser</span>: <span class="literal">true</span>, <span class="attr">useUnifiedTopology</span>: <span class="literal">true</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//new toySchema</span></span><br><span class="line"><span class="keyword">var</span> toySchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">    name: <span class="built_in">String</span>,</span><br><span class="line">    picture: <span class="built_in">String</span>,</span><br><span class="line">    description: <span class="built_in">String</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//create model Toy to use all methods</span></span><br><span class="line"><span class="keyword">var</span> Toy = mongoose.model(<span class="string">&quot;Toy&quot;</span>, toySchema);</span><br><span class="line"></span><br><span class="line"><span class="comment">//create toy</span></span><br><span class="line">Toy.create(newToy, <span class="function"><span class="keyword">function</span>(<span class="params">err, newCreatedToy</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(err);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res.redirect(<span class="string">&quot;/toys&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Find all toys</span></span><br><span class="line">Toy.find(&#123;&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err, toys</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (err)&#123;</span><br><span class="line">          <span class="built_in">console</span>.log(err);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          res.render(<span class="string">&quot;toys&quot;</span>, &#123;<span class="attr">toys</span>: toys&#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<p>use partials for footer and header</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- include (&#39;partials&#x2F;header&#39;) %&gt;</span><br><span class="line"></span><br><span class="line">&lt;%- include (&#39;partials&#x2F;footer&#39;) %&gt;</span><br></pre></td></tr></table></figure>

<h2 id="HTML-tips"><a href="#HTML-tips" class="headerlink" title="HTML tips"></a>HTML tips</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">html &lt;head&gt;&lt;&#x2F;head&gt; need &lt;title&gt;&lt;&#x2F;title&gt;</span><br><span class="line"></span><br><span class="line">src in &lt;img&gt; &quot;源&quot;，href in &lt;a&gt; “超链接”。</span><br></pre></td></tr></table></figure>

<h2 id="give-a-border-effect-to-picture"><a href="#give-a-border-effect-to-picture" class="headerlink" title="give a border effect to picture"></a>give a border effect to picture</h2><p>class = “thumbnail”<br>class = “caption”</p>
<h2 id="picture-align-affect-the-adaptive-screen-size"><a href="#picture-align-affect-the-adaptive-screen-size" class="headerlink" title="picture align (affect the adaptive screen size)"></a>picture align (affect the adaptive screen size)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">style &#x3D; &quot;display: flex; flex-warp: warp;&quot;</span><br></pre></td></tr></table></figure>

<h2 id="text-center-align"><a href="#text-center-align" class="headerlink" title="text center align"></a>text center align</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class = &quot;text-center&quot;</span><br></pre></td></tr></table></figure>

<h2 id="margin"><a href="#margin" class="headerlink" title="margin"></a>margin</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">margin</span>: 70<span class="selector-tag">px</span> <span class="comment">/*up + down*/</span> <span class="selector-tag">auto</span> <span class="comment">/*left + right*/</span>;</span><br></pre></td></tr></table></figure>

<h2 id="form"><a href="#form" class="headerlink" title="form"></a>form</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;description&quot;</span>&gt;</span>Description<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span> = <span class="string">&quot;form-control&quot;</span> <span class="attr">type</span> = <span class="string">&quot;text&quot;</span> <span class="attr">name</span> = <span class="string">&quot;description&quot;</span> <span class="attr">placeholder</span> = <span class="string">&quot;Toy description&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="control-form"><a href="#control-form" class="headerlink" title="control form"></a>control form</h2><p>style = “width: 30%; margin: 0 auto;</p>
<h2 id="download-mongoose-with-specific-version"><a href="#download-mongoose-with-specific-version" class="headerlink" title="download mongoose with specific version"></a>download mongoose with specific version</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save mongoose@5.3.15</span><br></pre></td></tr></table></figure>

<h2 id="uninstall-mongoose"><a href="#uninstall-mongoose" class="headerlink" title="uninstall mongoose"></a>uninstall mongoose</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm uninstall mongoose;</span><br></pre></td></tr></table></figure>

<h2 id="delete-the-whole-collection"><a href="#delete-the-whole-collection" class="headerlink" title="delete the whole collection"></a>delete the whole collection</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ db.collection.drop();</span><br></pre></td></tr></table></figure>

<h2 id="export-model"><a href="#export-model" class="headerlink" title="export model"></a>export model</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = mongoose.model(<span class="string">&quot;Toy&quot;</span>, toySchema);</span><br></pre></td></tr></table></figure>

<h2 id="use-model"><a href="#use-model" class="headerlink" title="use model"></a>use model</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Toy = <span class="built_in">require</span>(<span class="string">&quot;./models/toy&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="delete-all-items-in-Toy，remove-is-out-of-date"><a href="#delete-all-items-in-Toy，remove-is-out-of-date" class="headerlink" title="delete all items in Toy，remove() is out of date"></a>delete all items in Toy，remove() is out of date</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Toy.deleteMany(&#123;&#125;, function(err)&#123;</span><br><span class="line">       if (err)&#123;</span><br><span class="line">           console.log(err);</span><br><span class="line">       &#125; else &#123;</span><br><span class="line">           console.log(&quot;Remove all Toys!&quot;);</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<h2 id="分左右两个栏目可以用这个"><a href="#分左右两个栏目可以用这个" class="headerlink" title="分左右两个栏目可以用这个"></a>分左右两个栏目可以用这个</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> = <span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> = <span class="string">&quot;col-md-9&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> = <span class="string">&quot;col-md-3&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="add-more-directory-excepts-views"><a href="#add-more-directory-excepts-views" class="headerlink" title="add more directory excepts views"></a>add more directory excepts views</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.use(express.static(__dirname + <span class="string">&quot;/public&quot;</span>));</span><br></pre></td></tr></table></figure>

<h2 id="references-in-header"><a href="#references-in-header" class="headerlink" title="references in header"></a>references in header</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span> = <span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span> = <span class="string">&quot;/stylesheets/main.css&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="install-user-authentication"><a href="#install-user-authentication" class="headerlink" title="install user authentication"></a>install user authentication</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install passport passport-local passport-local-mongoose express-session --save</span><br></pre></td></tr></table></figure>

<h2 id="before-using-user-authentication"><a href="#before-using-user-authentication" class="headerlink" title="before using user authentication"></a>before using user authentication</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> passport = <span class="built_in">require</span>(<span class="string">&quot;passport&quot;</span>),</span><br><span class="line">    localStrategy = <span class="built_in">require</span>(<span class="string">&quot;passport-local&quot;</span>),</span><br><span class="line">    User = <span class="built_in">require</span>(<span class="string">&quot;./models/user&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="links-for-navbar"><a href="#links-for-navbar" class="headerlink" title="links for navbar"></a>links for navbar</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="within-User-model"><a href="#within-User-model" class="headerlink" title="within User model"></a>within User model</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> passportLocalMongoose = <span class="built_in">require</span>(<span class="string">&quot;passport-local-mongoose&quot;</span>);</span><br><span class="line"><span class="comment">//Creating UserSchema here!</span></span><br><span class="line">UserSchema.plugin(passportLocalMongoose);</span><br></pre></td></tr></table></figure>

<h2 id="landing-slider"><a href="#landing-slider" class="headerlink" title="landing slider"></a>landing slider</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g nodemon</span><br><span class="line">$ nodemon app.js</span><br></pre></td></tr></table></figure>

<h2 id="register-user"><a href="#register-user" class="headerlink" title="register user"></a>register user</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">app.post(<span class="string">&quot;/register&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> newUser = <span class="keyword">new</span> User(&#123;<span class="attr">username</span>: req.body.username&#125;);</span><br><span class="line">    User.register(newUser, req.body.password, <span class="function"><span class="keyword">function</span>(<span class="params">err, user</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(err);</span><br><span class="line">            <span class="keyword">return</span> res.render(<span class="string">&quot;register&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            passport.authenticate(<span class="string">&quot;local&quot;</span>)(req, res, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                res.redirect(<span class="string">&quot;/campgrounds&quot;</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="user-login"><a href="#user-login" class="headerlink" title="user login"></a>user login</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app.post(<span class="string">&quot;/login&quot;</span>, passport.authenticate(<span class="string">&quot;local&quot;</span>, &#123;<span class="attr">successRedirect</span>: <span class="string">&quot;/toys&quot;</span>, <span class="attr">failureRedirect</span>: <span class="string">&quot;/login&quot;</span>&#125;), <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123; </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Check-whether-it-is-login-middleware"><a href="#Check-whether-it-is-login-middleware" class="headerlink" title="Check whether it is login middleware"></a>Check whether it is login middleware</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isLoggedIn</span>(<span class="params">req, res, next</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (req.isAuthenticated())&#123;</span><br><span class="line">        <span class="keyword">return</span> next();</span><br><span class="line">    &#125;</span><br><span class="line">    res.redirect(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="use-a-middleware-for-all-route-getting-currentUser"><a href="#use-a-middleware-for-all-route-getting-currentUser" class="headerlink" title="use a middleware for all route getting currentUser"></a>use a middleware for all route getting currentUser</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>)</span>&#123;</span><br><span class="line">    res.locals.currentUser = req.user;</span><br><span class="line">    next();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;% if (!currentUser)&#123; %&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Route-Refactoring"><a href="#Route-Refactoring" class="headerlink" title="Route Refactoring"></a>Route Refactoring</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> commentRoutes = <span class="built_in">require</span>(<span class="string">&quot;./routes/comments&quot;</span>),</span><br><span class="line">    toyRoutes   = <span class="built_in">require</span>(<span class="string">&quot;./routes/toys&quot;</span>),</span><br><span class="line">    indexRoutes  = <span class="built_in">require</span>(<span class="string">&quot;./routes/index&quot;</span>);</span><br><span class="line"></span><br><span class="line">app.use(<span class="string">&quot;/&quot;</span>, indexRoutes);</span><br><span class="line">app.use(<span class="string">&quot;/toys&quot;</span>, toyRoutes);</span><br><span class="line">app.use(<span class="string">&quot;/toys/:id/comment&quot;</span>, commentRoutes);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>),</span><br><span class="line">    router  = express.Router(&#123;<span class="attr">mergeParams</span>: <span class="literal">true</span>&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="update-author-in-comment"><a href="#update-author-in-comment" class="headerlink" title="update author in comment"></a>update author in comment</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> commentSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">    author: &#123;</span><br><span class="line">        id: &#123;</span><br><span class="line">            type: mongoose.Schema.Types.ObjectId,</span><br><span class="line">            ref: <span class="string">&quot;User&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        username: <span class="built_in">String</span></span><br><span class="line">    &#125;,</span><br><span class="line">    content: <span class="built_in">String</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> newComment = &#123;</span><br><span class="line">    author: &#123;</span><br><span class="line">        id: req.user._id,</span><br><span class="line">        username: req.user.username</span><br><span class="line">    &#125;,</span><br><span class="line">    content: req.body.content</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="use-PUT"><a href="#use-PUT" class="headerlink" title="use PUT"></a>use PUT</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install method-override --save</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> methodOverride = <span class="built_in">require</span>(<span class="string">&quot;method-override&quot;</span>);</span><br><span class="line"></span><br><span class="line">app.use(methodOverride(<span class="string">&quot;_method&quot;</span>));</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span> = <span class="string">&quot;/toys/&lt;%= toy._id %&gt;/edit?_method=PUT&quot;</span> <span class="attr">method</span> = <span class="string">&quot;POST&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Update-toy-route"><a href="#Update-toy-route" class="headerlink" title="Update toy route"></a>Update toy route</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">router.put(<span class="string">&quot;/:id&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">    Toy.findOneAndUpdate(&#123;<span class="attr">_id</span>: req.params.id&#125;, req.body.toy, &#123;<span class="attr">upsert</span>: <span class="literal">true</span>, <span class="attr">useFindAndModify</span>: <span class="literal">false</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err, updatedToy</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(err);</span><br><span class="line">            res.redirect(<span class="string">&quot;/toys&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res.redirect(<span class="string">&quot;/toys/&quot;</span> + req.params.id);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Destroy toy route</span></span><br><span class="line">router.delete(<span class="string">&quot;/:id&quot;</span>, checkToyOwnership, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">    Toy.findByIdAndRemove(req.params.id, &#123;<span class="attr">useFindAndModify</span>: <span class="literal">false</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err)&#123;</span><br><span class="line">            res.redirect(<span class="string">&quot;/toys&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res.redirect(<span class="string">&quot;/toys&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span> = <span class="string">&quot;/toys/&lt;%= toy._id %&gt;/comment/&lt;%= comment._id %&gt;?_method=DELETE&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">style</span> = <span class="string">&quot;display: inline&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span> = <span class="string">&quot;btn btn-danger&quot;</span>&gt;</span>Delete<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="User-Authorization"><a href="#User-Authorization" class="headerlink" title="User Authorization"></a>User Authorization</h2><p>already login, check permission</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkToyOwnership</span>(<span class="params">req, res, next</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (req.isAuthenticated())&#123;</span><br><span class="line">        Toy.findById(req.params.id, <span class="function"><span class="keyword">function</span>(<span class="params">err, toy</span>)</span>&#123;</span><br><span class="line">           <span class="keyword">if</span> (err)&#123;</span><br><span class="line">               res.redirect(<span class="string">&quot;/toys&quot;</span>);</span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               <span class="keyword">if</span> (toy.author.id.equals(req.user._id))&#123;</span><br><span class="line">                    next();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                   <span class="built_in">console</span>.log(<span class="string">&quot;You don&#x27;t have permission&quot;</span>);</span><br><span class="line">                    res.redirect(<span class="string">&quot;back&quot;</span>);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;need to login first&quot;</span>);</span><br><span class="line">        res.redirect(<span class="string">&quot;back&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="auto-hide-button-not-belong-to-you"><a href="#auto-hide-button-not-belong-to-you" class="headerlink" title="auto hide button not belong to you"></a>auto hide button not belong to you</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;% if (currentUser &amp;&amp; toy.author.id.equals(currentUser._id))&#123; %&gt;</span><br><span class="line">        &lt;form class &#x3D; &quot;delete-form&quot; action &#x3D; &quot;&#x2F;toys&#x2F;&lt;%&#x3D; toy._id %&gt;&#x2F;edit&quot; method&#x3D;&quot;GET&quot;&gt;</span><br><span class="line">              &lt;button class &#x3D; &quot;btn btn-warning&quot;&gt;Edit&lt;&#x2F;button&gt;</span><br><span class="line">        &lt;&#x2F;form&gt;</span><br><span class="line">        &lt;form class &#x3D; &quot;delete-form&quot; action &#x3D; &quot;&#x2F;toys&#x2F;&lt;%&#x3D; toy._id %&gt;?_method&#x3D;DELETE&quot; method&#x3D;&quot;POST&quot;&gt;</span><br><span class="line">              &lt;button class &#x3D; &quot;btn btn-danger&quot;&gt;Delete&lt;&#x2F;button&gt;</span><br><span class="line">        &lt;&#x2F;form&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>

<h2 id="connect-flash"><a href="#connect-flash" class="headerlink" title="connect-flash"></a>connect-flash</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save connect-flash</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> flash = <span class="built_in">require</span>(<span class="string">&quot;connect-flash&quot;</span>);</span><br><span class="line"></span><br><span class="line">app.use(flash());</span><br><span class="line"></span><br><span class="line">req.flash(<span class="string">&quot;error&quot;</span>, <span class="string">&quot;Please Login First!&quot;</span>); <span class="comment">//before redirect</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;% if (error &amp;&amp; error.length &gt; 0)&#123; %&gt;</span><br><span class="line">        &lt;div class &#x3D; &quot;alert alert-danger&quot; role &#x3D; &quot;alert&quot;&gt;&lt;%&#x3D; error %&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;% &#125; else if (success &amp;&amp; success.length &gt; 0) &#123; %&gt;</span><br><span class="line">        &lt;div class &#x3D; &quot;alert alert-success&quot; role &#x3D; &quot;alert&quot;&gt;&lt;%&#x3D; success %&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (err)&#123;</span><br><span class="line">      req.flash(<span class="string">&quot;error&quot;</span>, err.message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/03/AWS-ToysHub/" data-id="ckde5fodl0000fiqv6bqsci67" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Hexo Tutorial" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/08/03/Hexo%20Tutorial/" class="article-date">
  <time datetime="2020-08-03T03:55:24.000Z" itemprop="datePublished">2020-08-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/08/03/Hexo%20Tutorial/">How to build a Hexo blog to Github via AWS Cloud9</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Build-the-hexo-blog-in-AWS-Cloud9-firstly"><a href="#Build-the-hexo-blog-in-AWS-Cloud9-firstly" class="headerlink" title="Build the hexo blog in AWS Cloud9 firstly"></a>Build the hexo blog in AWS Cloud9 firstly</h2><ol>
<li>Create a Cloud9 instance in AWS</li>
<li>$ hexo new “My New Post”</li>
<li>$ hexo init</li>
<li>$ npm install</li>
<li>$ npm install hexo-server –save</li>
<li>$ hexo server</li>
</ol>
<h2 id="Deploy-it-to-the-Github"><a href="#Deploy-it-to-the-Github" class="headerlink" title="Deploy it to the Github"></a>Deploy it to the Github</h2><ol>
<li>Create a new repositoy “<username>.github.io”</li>
<li>$ npm install hexo-deployer-git –save</li>
<li>Change the “_config.yml”<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:yuxuanzhao/yuxuanzhao.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure></li>
<li>$ ssh-keygen -t rsa</li>
<li>Copy public key to Github SSH setting </li>
<li>$ ssh -T <a href="mailto:&#x67;&#x69;&#116;&#64;&#x67;&#105;&#x74;&#104;&#x75;&#x62;&#46;&#99;&#111;&#109;">&#x67;&#x69;&#116;&#64;&#x67;&#105;&#x74;&#104;&#x75;&#x62;&#46;&#99;&#111;&#109;</a> //validate the connection</li>
</ol>
<h2 id="Commit-to-Github"><a href="#Commit-to-Github" class="headerlink" title="Commit to Github"></a>Commit to Github</h2><ol>
<li>$ hexo clean //not necessary</li>
<li>$ hexo g</li>
<li>$ hexo d</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/03/Hexo%20Tutorial/" data-id="ckde5fods0001fiqv3x8s3s1c" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/08/04/BackEnd-notes/">BackEnd notes</a>
          </li>
        
          <li>
            <a href="/2020/08/04/FrontEnd-notes/">FrontEnd notes</a>
          </li>
        
          <li>
            <a href="/2020/08/04/Vue-js-note/">Vue.js note</a>
          </li>
        
          <li>
            <a href="/2020/08/03/AWS-ToysHub/">AWS-ToysHub</a>
          </li>
        
          <li>
            <a href="/2020/08/03/Hexo%20Tutorial/">How to build a Hexo blog to Github via AWS Cloud9</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Eason Chiu<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>